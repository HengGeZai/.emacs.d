* 包管理函数
  #+BEGIN_SRC emacs-lisp
    ;; 加载源
    (when (>= emacs-major-version 24)
        (require 'package)
        (package-initialize)
        (add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/") t))

    ;; cl - Common Lisp Extension
    (require 'cl)
    (defvar chongliang/packages '(
                     company
                     monokai-theme
                     hungry-delete
                     swiper
                     counsel
                     smartparens
                     exec-path-from-shell
                     popwin
                     expand-region
                     iedit
                     evil
                     evil-leader
                     evil-surround
                     evil-nerd-commenter
                     window-numbering
                     which-key
                     helm-ag
                     yasnippet
                     auto-yasnippet
                     ess
                     electric-spacing
                     polymode
                     r-autoyas
                     flycheck
                     markdown-mode
                     auto-complete
                     bash-completion
                     chinese-pyim
                   ) "Default packages")

    (setq package-selected-packages chongliang/packages)

    (defun chongliang/packages-installed-p ()
        (loop for pkg in chongliang/packages
              when (not (package-installed-p pkg)) do (return nil)
              finally (return t)))

    (unless (chongliang/packages-installed-p)
        (message "%s" "Refreshing package database...")
        (package-refresh-contents)
        (dolist (pkg chongliang/packages)
          (when (not (package-installed-p pkg))
            (package-install pkg))))
  #+END_SRC
* 快速打开配置文件
  #+BEGIN_SRC emacs-lisp
    (defun open-init-file()
    (interactive)
    (find-file "~/.emacs.d/my.configs.org"))
  #+END_SRC
* openGTD
  #+BEGIN_SRC emacs-lisp
    (defun open-GTD()
    (interactive)
    (find-file "~/GTD/GTD.org"))
  #+END_SRC
* 自动缩进函数
  #+BEGIN_SRC emacs-lisp
    (defun indent-buffer ()
      "Indent the currently visited buffer."
      (interactive)
      (indent-region (point-min) (point-max)))

    (defun indent-region-or-buffer ()
      "Indent a region if selected, otherwise the whole buffer. "
      (interactive)
      (save-excursion
        (if (region-active-p)
            (progn
              (indent-region (region-beginning) (region-end))
              (message "Indented selected region."))
          (progn
            (indent-buffer)
    (message "Indented buffer.")))))
  #+END_SRC
* occur自动匹配光标所在词-occur-dwim
  #+BEGIN_SRC emacs-lisp
    (defun occur-dwim ()
      "Call `occur' with a sane default."
      (interactive)
      (push (if (region-active-p)
                (buffer-substring-no-properties
                 (region-beginning)
                 (region-end))
              (let ((sym (thing-at-point 'symbol)))
                (when (stringp sym)
                  (regexp-quote sym))))
            regexp-history)
      (call-interactively 'occur))
  #+END_SRC
* 将org编译成elc
  #+BEGIN_SRC emacs-lisp
    (defun chongliang/org-to-elc ()
      (interactive)
      (setq-local filename (string= (substring (buffer-file-name) 0 26) "/home/chongliang/.emacs.d/"))
      (if filename
          (org-babel-load-file (buffer-file-name)))
      (if filename
          (byte-compile-file
           (concat
            (substring (buffer-file-name) 0 (string-match "\\(.org\\)" (buffer-file-name))) ".el"))))
  #+END_SRC
* newline-at-last-line
  used in：file:~/.emacs.d/init-packages.org::ESS
  #+BEGIN_SRC emacs-lisp
    (defun chongliang/newline-at-last-line ()
      (interactive)
      (let ((opoint (point)) end)
        (save-excursion
        (forward-page)
        (setq end (point)))
        (if (= 0 (count-lines opoint end))
            (progn
              (move-end-of-line 1)
              (newline)))))
  #+END_SRC
